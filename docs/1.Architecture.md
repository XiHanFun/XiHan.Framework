# XiHan.Framework 架构

XiHan.Framework 的包架构，专为前后端分离的 ASP.NET Core 应用设计。框架基于 .NET 9，优先使用原生功能，减少第三方依赖，确保模块化、可扩展和易用性。命名空间根据项目类型区分：

- **XiHan.Framework.[ModuleName]**: 通用类库，使用 `Microsoft.NET.Sdk`。
- **XiHan.Framework.Web.[ModuleName]**: Web 相关功能，使用 `Microsoft.NET.Sdk.Web`。

## 设计原则

- **分层架构**：遵循清晰的分层原则，避免循环依赖，确保架构的可维护性。
- **依赖倒置**：高层模块不依赖低层模块，都依赖抽象接口。
- **单一职责**：每个包只负责一个特定的功能领域。
- **开闭原则**：对扩展开放，对修改关闭，通过接口和抽象类支持自定义。
- **优先 .NET 9**：使用内置功能（如 DI、日志、序列化），仅在必要时兼容第三方库。
- **国内外环境**：提供中文文档，兼容国际标准（OpenAPI、gRPC）。
- **性能优化**：利用 .NET 9 AOT 编译和高性能特性，提供性能基准数据。
- **快速启动**：确保用户下载后即可运行完整的 Web API 项目，快速体验框架功能。

## 包详细说明

### XiHan.Framework

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 框架元数据和基础配置。
- **详细描述**: 包含框架版本信息等，为所有其他包提供基础支持。
- **依赖**: 无（元数据包）。

**基本功能：**

- 框架元数据定义 (`FrameworkMetadata`)
- 全局配置管理 (`GlobalConfigurationManager`)
- 框架诊断信息 (`FrameworkDiagnostics`)
- 兼容性检查器 (`CompatibilityChecker`)
- 框架初始化引导 (`FrameworkBootstrapper`)

### XiHan.Framework.Core

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供框架核心工具、依赖注入、模块化支持。
- **详细描述**: 包含通用扩展方法、基类和配置管理工具，集成 .NET 9 内置 DI，支持服务注册与解析，模块化设计，提升开发效率。
- **依赖**: XiHan.Framework。

**基本功能：**

- 模块系统核心 (`IModuleDescriptor`, `ModuleLoader`, `ModuleRegistry`)
- 依赖注入容器 (`ServiceCollectionBuilder`, `ServiceLifetimeManager`)
- 配置绑定器 (`IConfigurationBinder<T>`, `ConfigurationValidator`)
- 选项模式支持 (`IOptionsSnapshot<T>`, `OptionsChangeTracker`)
- 异常处理链 (`ExceptionProcessor`, `IExceptionHandler`)
- 结果模式实现 (`Result<T>`, `OperationResult`, `ValidationResult`)
- 实体基础抽象 (`IEntity<TKey>`, `IAggregateRoot<TKey>`, `IAuditable`)
- 服务定位模式 (`IServiceResolver`, `ScopedServiceProvider`)
- 应用生命周期 (`IHostedLifecycleService`, `IApplicationInitializer`)
- 值对象系统 (`ValueObject<T>`, `IEquatable<T>`, `IComparable<T>`)

### XiHan.Framework.Utils

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供通用工具和扩展方法。
- **详细描述**: 包含字符串处理、日期时间操作、加密解密、反射工具等实用方法，简化日常开发任务。
- **依赖**: XiHan.Framework。

**基本功能：**

- 高性能字符串处理 (`StringProcessor`, `IStringFormatter`, `StringPool`)
- 时间处理器 (`TimeProvider`, `DateTimeFormatter`, `TimeZoneManager`)
- 加密算法抽象 (`ICryptographyProvider`, `HashAlgorithmFactory`)
- 类型系统工具 (`TypeAnalyzer`, `AssemblyScanner`, `GenericTypeBuilder`)
- 函数式集合操作 (`IEnumerableExtensions`, `AsyncEnumerableExtensions`)
- 文件系统抽象 (`IFileSystem`, `PathNormalizer`, `FileWatcher`)
- 安全随机生成器 (`ICryptoRandom`, `SecureRandomProvider`)
- 表达式构建器 (`ExpressionBuilder<T>`, `PredicateComposer`)

### XiHan.Framework.Serialization

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持对象序列化和反序列化。
- **详细描述**: 基于 System.Text.Json 提供高效 JSON 序列化，支持自定义转换器，兼容 Newtonsoft.Json。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 序列化器工厂 (`ISerializerFactory`, `SerializerRegistry`)
- 高性能 JSON 处理 (`IJsonProcessor`, `Utf8JsonSerializer`)
- 序列化上下文 (`SerializationContext`, `ISerializationContract`)
- 流式序列化器 (`IStreamSerializer<T>`, `AsyncSerializer`)
- 格式检测器 (`FormatDetector`, `IContentTypeResolver`)
- 序列化管道 (`SerializationPipeline`, `ISerializationMiddleware`)

### XiHan.Framework.Logging

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 统一日志记录与管理。
- **详细描述**: 基于 .NET 9 日志框架，支持结构化日志、多目标输出（如文件、控制台），兼容 Serilog 等扩展库。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 日志提供者抽象 (`ILoggerProvider<T>`, `LoggerFactory`)
- 结构化日志处理 (`IStructuredLogger`, `LogEventProcessor`)
- 日志上下文管理 (`LogContext`, `CorrelationIdManager`, `LogScope`)
- 日志级别控制 (`ILogLevelController`, `DynamicLogLevelProvider`)
- 日志聚合器 (`LogAggregator`, `ILogEventSink`)
- 日志模板引擎 (`ILogTemplate`, `MessageTemplateProcessor`)

### XiHan.Framework.Domain

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供领域驱动设计的基础设施。
- **详细描述**: 包含领域实体、聚合根、领域服务、领域事件、值对象、领域枚举、常量、异常等核心概念，为复杂业务系统提供完整的领域建模支持。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 聚合边界管理 (`IAggregateRoot<TId>`, `AggregateTracker`, `AggregateStateManager`)
- 实体生命周期 (`IEntity<TId>`, `EntityStateTracker`, `EntityFactoryMethod`)
- 领域服务注册器 (`IDomainService`, `DomainServiceRegistrar`)
- 领域事件总线 (`IDomainEventBus`, `DomainEventDispatcher`, `EventOutbox`)
- 仓储规约模式 (`IRepository<TEntity, TId>`, `ISpecification<T>`)
- 领域规则引擎 (`IBusinessRule`, `BusinessRuleValidator`, `RuleComposer`)
- 领域策略工厂 (`IDomainStrategy<T>`, `StrategyResolver<T>`)
- 值对象构建器 (`ValueObject<T>`, `ValueObjectBuilder<T>`)
- 领域枚举系统 (`SmartEnum<T>`, `EnumerationExtensions`)
- 领域异常处理 (`DomainException`, `BusinessRuleViolationException`)

### XiHan.Framework.ObjectMapping

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供对象映射和转换功能。
- **详细描述**: 支持 Entity ↔ DTO 转换，集成 Mapster 或 AutoMapper，提供高性能对象映射，支持自定义映射规则和配置。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 映射器工厂 (`IMapperFactory<TSource, TDestination>`, `MapperRegistry`)
- 映射表达式编译器 (`IMappingExpressionBuilder`, `ExpressionCompiler`)
- 类型转换管道 (`ITypeConverter<TIn, TOut>`, `ConversionPipeline`)
- 映射配置构建器 (`IMappingConfiguration<T>`, `MappingProfileBuilder`)
- 条件映射器 (`IConditionalMapper`, `MappingConditionEvaluator`)
- 映射上下文 (`MappingContext`, `IMappingContextAccessor`)

### XiHan.Framework.Validation

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持数据输入验证。
- **详细描述**: 基于数据注解和 FluentValidation，提供模型验证和自定义规则，保障输入数据的可靠性。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 验证器工厂 (`IValidatorFactory<T>`, `ValidatorRegistry`)
- 验证规则构建器 (`IValidationRuleBuilder<T>`, `ValidationRuleComposer`)
- 验证上下文 (`ValidationContext<T>`, `IValidationContextAccessor`)
- 异步验证器 (`IAsyncValidator<T>`, `AsyncValidationPipeline`)
- 验证结果聚合器 (`IValidationResultAggregator`, `ValidationSummary`)
- 条件验证器 (`IConditionalValidator<T>`, `ValidatorConditionBuilder`)

### XiHan.Framework.Security

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供安全相关的基础功能。
- **详细描述**: 包含加密解密、哈希算法、数字签名等安全工具，为认证授权提供基础支持。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Utils。

**基本功能：**

- 密码学提供者 (`ICryptographyProvider`, `CryptographyServiceFactory`)
- 密钥管理器 (`IKeyManager`, `KeyRotationService`, `KeyDerivationProvider`)
- 数据保护器 (`IDataProtector`, `DataProtectionPipelineBuilder`)
- 哈希验证器 (`IHashValidator`, `PasswordHashingProvider`)
- 安全上下文 (`ISecurityContext`, `SecurityContextAccessor`)
- 审计记录器 (`ISecurityAuditor`, `SecurityEventLogger`)

### XiHan.Framework.Threading

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供线程安全和异步编程工具。
- **详细描述**: 包含锁机制、线程池管理、异步任务调度等功能，优化多线程应用开发。
- **依赖**: XiHan.Framework.Core。

**基本功能：**

- 并发原语 (`IAsyncSemaphore`, `AsyncReaderWriterLock`, `AsyncMutex`)
- 任务调度器 (`ITaskScheduler`, `PriorityTaskScheduler`, `ThrottlingTaskScheduler`)
- 并发执行器 (`IConcurrentExecutor<T>`, `ParallelExecutionPipeline`)
- 线程安全集合 (`IConcurrentCollection<T>`, `LockFreeQueue<T>`)
- 异步操作管理 (`IAsyncOperationManager`, `CancellationTokenManager`)
- 背压控制器 (`IBackpressureController`, `FlowControlManager`)

### XiHan.Framework.DistributedIds

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 生成分布式唯一 ID。
- **详细描述**: 实现雪花算法（Snowflake）或其他 ID 生成策略，确保分布式系统中 ID 唯一性。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Threading。

**基本功能：**

- ID 生成器工厂 (`IIdGeneratorFactory`, `IdGeneratorRegistry`)
- 算法提供者 (`ISnowflakeProvider`, `IUlidProvider`, `ISqidProvider`, `INanoIdProvider`)
- ID 序列管理器 (`ISequenceManager`, `DistributedSequenceProvider`)
- 时间戳提供者 (`ITimestampProvider`, `CustomEpochProvider`)
- ID 验证和解析 (`IIdParser<T>`, `IdValidationService`)
- 节点协调器 (`INodeCoordinator`, `WorkerNodeManager`)

### XiHan.Framework.Web.Core

- **SDK**: Microsoft.NET.Sdk.Web
- **简要功能**: 支持 Web 应用的基础配置和运行时环境。
- **详细描述**: 提供 ASP.NET Core 的 WebHost 和 Kestrel 配置，简化中间件管道设置，适用于快速搭建 Web 项目。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Logging。

**基本功能：**

- Web 主机构建器 (`IWebHostBuilder`, `WebHostConfigurationProvider`)
- 中间件管道编排 (`IMiddlewarePipeline`, `MiddlewareComposer`, `ConditionalMiddleware`)
- HTTP 上下文抽象 (`IHttpContextAccessor`, `HttpContextEnricher`)
- 请求/响应处理器 (`IRequestProcessor`, `IResponseProcessor`, `HttpMessagePipeline`)
- Web 生命周期管理 (`IWebApplicationLifecycle`, `StartupTaskRunner`)
- 健康检查聚合器 (`IHealthCheckAggregator`, `HealthCheckReporter`)

### XiHan.Framework.Data

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供数据访问和 ORM 工具。
- **详细描述**: 集成 Entity Framework Core、SqlSugar 和 Dapper，支持迁移、仓储模式和数据操作，适用于多种数据库场景。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Domain, XiHan.Framework.Threading。

**基本功能：**

- 数据上下文工厂 (`IDbContextFactory<T>`, `DbContextPoolManager`)
- 仓储模式实现 (`IRepository<TEntity, TKey>`, `IQueryableRepository<T>`)
- 规约模式支持 (`ISpecification<T>`, `SpecificationBuilder<T>`, `CompositeSpecification<T>`)
- 数据迁移管理 (`IMigrationRunner`, `SchemaVersionManager`, `MigrationHistoryTracker`)
- 查询优化器 (`IQueryOptimizer`, `QueryExecutionPlanAnalyzer`)
- 数据访问拦截器 (`IDataInterceptor`, `QueryInterceptionPipeline`)
- 连接管理器 (`IConnectionManager`, `ConnectionPoolProvider`, `DatabaseHealthChecker`)
- 数据审计追踪 (`IDataAuditTracker`, `ChangeDetectionService`, `AuditLogProcessor`)

### XiHan.Framework.Uow

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供工作单元（Unit of Work）模式实现。
- **详细描述**: 实现完整的工作单元模式，管理事务边界、数据库连接和事务行为，支持嵌套工作单元、事务回滚和事件发布，确保数据一致性。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Threading。

**基本功能：**

- 工作单元工厂 (`IUnitOfWorkFactory`, `UnitOfWorkBuilder`)
- 事务协调器 (`ITransactionCoordinator`, `DistributedTransactionManager`)
- 工作单元上下文 (`IUnitOfWorkContext`, `UnitOfWorkScope`)
- 事务策略管理 (`ITransactionStrategy`, `TransactionPolicyProvider`)
- 变更追踪器 (`IChangeTracker`, `EntityChangeDetector`)
- 事务后处理器 (`IPostTransactionProcessor`, `CommitCallbackManager`)
- 并发控制器 (`IConcurrencyController`, `OptimisticLockManager`)
- 工作单元拦截管道 (`IUnitOfWorkInterceptor`, `InterceptionPipeline`)

### XiHan.Framework.Caching

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 优化应用缓存管理。
- **详细描述**: 支持内存缓存和分布式缓存（如 Redis），支持分级缓存、缓存优先级、缓存统计、缓存策略、缓存淘汰策略、缓存预热，提升性能和响应速度。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Threading。

**基本功能：**

- 缓存抽象层 (`ICacheProvider<T>`, `CacheProviderFactory`)
- 多级缓存管理 (`IMultiLevelCache`, `CacheLayerCoordinator`)
- 缓存策略引擎 (`ICacheStrategy`, `EvictionPolicyManager`, `ExpirationPolicyProvider`)
- 缓存序列化器 (`ICacheSerializer<T>`, `CompressedCacheSerializer`)
- 缓存失效通知 (`ICacheInvalidationNotifier`, `CacheInvalidationBus`)
- 缓存性能监控 (`ICacheMetrics`, `CachePerformanceAnalyzer`)
- 缓存预热调度器 (`ICacheWarmupScheduler`, `BackgroundCacheLoader`)
- 分布式缓存协调 (`IDistributedCacheCoordinator`, `ConsistentHashingProvider`)

### XiHan.Framework.SearchEngines

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供全文搜索和索引功能。
- **详细描述**: 集成 Elasticsearch，支持高效搜索、数据索引和查询优化，适用于搜索密集型应用。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Threading。

**基本功能：**

- 搜索引擎抽象 (`ISearchEngine<T>`, `SearchEngineFactory`)
- 索引构建器 (`IIndexBuilder<T>`, `DocumentIndexProcessor`)
- 查询引擎 (`IQueryEngine`, `FullTextQueryProcessor`, `FacetedSearchProcessor`)
- 搜索结果聚合器 (`ISearchResultAggregator<T>`, `SearchResultRanker`)
- 搜索分析器 (`ISearchAnalyzer`, `TextAnalysisEngine`)
- 索引同步器 (`IIndexSynchronizer`, `RealTimeIndexUpdater`)
- 搜索性能优化 (`ISearchOptimizer`, `QueryPerformanceAnalyzer`)
- 搜索建议引擎 (`ISuggestionEngine`, `AutoCompleteProvider`)

### XiHan.Framework.Authentication

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 实现用户身份认证功能。
- **详细描述**: 支持 JWT、OAuth 2.0 和 OpenID Connect，集成 ASP.NET Core Identity，提供登录、令牌生成与验证功能。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Security, XiHan.Framework.Utils, XiHan.Framework.Threading。

**基本功能：**

- 身份提供者 (`IIdentityProvider`, `IdentityProviderRegistry`)
- 认证处理器 (`IAuthenticationHandler`, `AuthenticationSchemeProvider`)
- 令牌服务工厂 (`ITokenServiceFactory`, `JwtTokenService`, `RefreshTokenService`)
- 认证结果处理 (`IAuthenticationResultHandler`, `AuthenticationFailureHandler`)
- 会话管理器 (`ISessionManager`, `SessionStateProvider`)
- 多因素认证 (`IMfaProvider`, `TotpProvider`, `SmsProvider`)
- 认证事件处理 (`IAuthenticationEventHandler`, `SecurityEventLogger`)
- 单点登录管理 (`ISsoManager`, `SamlProvider`, `OidcProvider`)

### XiHan.Framework.VirtualFileSystem

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 管理文件存储和访问。
- **详细描述**: 支持本地文件系统、云存储（如 AWS S3），提供文件上传、下载和权限控制。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Authentication, XiHan.Framework.Security。

**基本功能：**

- 虚拟文件系统 (`IVirtualFileSystem`, `VirtualFileProvider`)
- 文件存储适配器 (`IStorageAdapter`, `CloudStorageAdapter`, `LocalStorageAdapter`)
- 文件流管理器 (`IStreamManager`, `AsyncFileStreamProvider`)
- 文件元数据管理 (`IFileMetadataService`, `FileInfoExtractor`)
- 文件访问控制 (`IFileAccessController`, `PermissionEvaluator`)
- 文件版本控制 (`IFileVersionManager`, `FileHistoryTracker`)
- 文件内容索引 (`IFileIndexer`, `ContentSearchEngine`)
- 文件操作审计 (`IFileAuditor`, `FileOperationLogger`)

### XiHan.Framework.Messaging

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持消息队列与事件驱动开发。
- **详细描述**: 兼容 RabbitMQ 和 Kafka，提供消息发布与订阅机制，助力构建高扩展性事件驱动系统。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Threading。

**基本功能：**

- 消息代理抽象 (`IMessageBroker`, `MessageBrokerFactory`)
- 消息发布者 (`IMessagePublisher<T>`, `ReliableMessagePublisher`)
- 消息消费者 (`IMessageConsumer<T>`, `MessageConsumerGroup`)
- 消息路由器 (`IMessageRouter`, `TopicBasedRouter`, `ContentBasedRouter`)
- 消息管道 (`IMessagePipeline`, `MessageMiddlewarePipeline`)
- 消息保证机制 (`IMessageGuarantee`, `AtLeastOnceDelivery`, `ExactlyOnceDelivery`)
- 消息端点管理 (`IMessageEndpointManager`, `EndpointHealthMonitor`)
- 消息故障转移 (`IMessageFailover`, `CircuitBreakerMessageHandler`)

### XiHan.Framework.Http

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 封装 HTTP 客户端。
- **详细描述**: 基于 HttpClientFactory，提供重试、超时、认证等功能，简化外部 API 调用。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Threading。

**基本功能：**

- HTTP 客户端工厂 (`IHttpClientFactory`, `HttpClientRegistry`)
- 请求构建器 (`IHttpRequestBuilder`, `FluentHttpRequestBuilder`)
- 响应处理管道 (`IHttpResponsePipeline`, `ResponseProcessor`)
- HTTP 拦截器 (`IHttpInterceptor`, `HttpInterceptorChain`)
- 重试策略引擎 (`IRetryStrategyEngine`, `ExponentialBackoffStrategy`)
- HTTP 缓存管理 (`IHttpCacheManager`, `ResponseCacheProvider`)
- API 客户端生成 (`IApiClientGenerator<T>`, `OpenApiClientFactory`)
- HTTP 性能监控 (`IHttpPerformanceMonitor`, `LatencyTracker`)

### XiHan.Framework.BackgroundJobs

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 管理后台任务和定时作业。
- **详细描述**: 集成 Hangfire 或 Quartz.NET，支持异步任务队列和定时调度，提供任务监控和管理功能。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Threading, XiHan.Framework.Serialization。

**基本功能：**

- 作业调度工厂 (`IJobSchedulerFactory`, `SchedulerRegistry`)
- 任务执行器 (`IJobExecutor<T>`, `JobExecutionContext`)
- 任务生命周期管理 (`IJobLifecycleManager`, `JobStateTransitionHandler`)
- 分布式任务管理 (`IDistributedJobManager`, `JobCoordinator`)
- 任务依赖解析 (`IJobDependencyResolver`, `DependencyGraphBuilder`)
- 任务重试策略 (`IJobRetryStrategy`, `RetryPolicyEngine`)
- 任务性能监控 (`IJobPerformanceMonitor`, `JobMetricsCollector`)
- 任务存储抽象 (`IJobStorageProvider`, `JobPersistenceManager`)

### XiHan.Framework.Templating

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持文本模板生成。
- **详细描述**: 集成 RazorLight 或 Scriban，提供动态模板渲染，用于邮件、报告和代码生成。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Utils。

**基本功能：**

- 模板引擎抽象 (`ITemplateEngine<T>`, `TemplateEngineRegistry`)
- 模板解析器 (`ITemplateParser`, `TemplateAstBuilder`)
- 模板编译器 (`ITemplateCompiler<T>`, `ExpressionTreeCompiler`)
- 模板上下文 (`ITemplateContext`, `TemplateVariableResolver`)
- 模板继承管理 (`ITemplateInheritanceManager`, `LayoutTemplateResolver`)
- 模板片段管理 (`ITemplatePartialManager`, `PartialTemplateRegistry`)
- 模板安全检查 (`ITemplateSecurityChecker`, `TemplateSecurityAnalyzer`)
- 模板性能优化 (`ITemplateOptimizer`, `TemplatePrecompiler`)

### XiHan.Framework.Localization

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持国际化与本地化。
- **详细描述**: 基于 .NET 9 的 `IStringLocalizer` 和资源文件（`.resx`）实现多语言支持，支持动态语言切换和本地化中间件，适用于多语言应用。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Web.Core, XiHan.Framework.Utils。

**基本功能：**

- 本地化提供者 (`ILocalizationProvider`, `LocalizationProviderFactory`)
- 资源解析器 (`IResourceResolver`, `HierarchicalResourceResolver`)
- 文化上下文管理 (`ICultureContext`, `CultureContextAccessor`)
- 多元化文本处理 (`IPluralRuleEngine`, `PluralFormatProvider`)
- 本地化键生成器 (`ILocalizationKeyGenerator`, `ConventionBasedKeyGenerator`)
- 文化时间格式化 (`ICultureFormatter`, `LocalizedDateTimeFormatter`)
- 本地化缓存管理 (`ILocalizationCacheManager`, `ResourceCacheInvalidator`)
- 本地化验证器 (`ILocalizationValidator`, `ResourceIntegrityChecker`)

### XiHan.Framework.AI

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 集成 AI 和机器学习功能。
- **详细描述**: 提供 ML.NET 或 TensorFlow.NET 集成，支持模型训练、推理和智能推荐。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Utils。

**基本功能：**

- AI 服务提供者 (`IAIServiceProvider`, `AIServiceFactory`)
- 机器学习管道 (`IMLPipeline<T>`, `ModelTrainingPipeline`)
- 模型管理器 (`IModelManager`, `ModelRegistry`, `ModelVersionManager`)
- 特征工程 (`IFeatureEngine`, `FeatureTransformer`, `FeatureSelector`)
- 模型评估器 (`IModelEvaluator`, `CrossValidationRunner`)
- AI 代理管理 (`IAIAgentManager`, `ConversationalAgent`, `TaskAgent`)
- 知识库管理 (`IKnowledgeBaseManager`, `VectorStoreProvider`)
- AI 性能监控 (`IAIPerformanceMonitor`, `ModelMetricsCollector`)

### XiHan.Framework.Script

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供脚本执行和动态代码运行能力。
- **详细描述**: 支持 JavaScript、Python 等脚本语言集成，提供脚本引擎、动态编译和脚本管理功能，适用于规则引擎和动态业务逻辑。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Security, XiHan.Framework.Utils。

**基本功能：**

- 脚本运行时 (`IScriptRuntime`, `ScriptRuntimeFactory`)
- 脚本编译器 (`IScriptCompiler<T>`, `DynamicCompilerProvider`)
- 脚本上下文 (`IScriptContext`, `ScriptExecutionContext`)
- 脚本模块管理 (`IScriptModuleManager`, `ModuleDependencyResolver`)
- 脚本安全管理 (`IScriptSecurityManager`, `SandboxExecutionEnvironment`)
- 脚本调试器 (`IScriptDebugger`, `BreakpointManager`)
- 脚本性能优化 (`IScriptOptimizer`, `ScriptProfiler`)
- 脚本事件管理 (`IScriptEventManager`, `ScriptEventBus`)

### XiHan.Framework.Authorization

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供权限管理和访问控制。
- **详细描述**: 支持角色、策略和声明的授权方式，与认证模块无缝协作，实现资源保护和权限校验。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Authentication, XiHan.Framework.Security。

**基本功能：**

- 授权策略引擎 (`IAuthorizationPolicyEngine`, `PolicyEvaluator`)
- 资源访问控制 (`IResourceAccessController`, `ResourcePermissionManager`)
- 角色管理器 (`IRoleManager`, `HierarchicalRoleProvider`)
- 权限解析器 (`IPermissionResolver`, `PermissionInheritanceResolver`)
- 授权上下文 (`IAuthorizationContext`, `AuthorizationContextAccessor`)
- 动态授权管理 (`IDynamicAuthorizationManager`, `RuntimePermissionEvaluator`)
- 授权事件处理 (`IAuthorizationEventHandler`, `AccessAuditLogger`)
- 细粒度权限控制 (`IFineGrainedAccessControl`, `AttributeBasedAccessControl`)

### XiHan.Framework.EventBus

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持事件总线和发布/订阅模式。
- **详细描述**: 提供本地和分布式事件处理，支持 MediatR、RabbitMQ，解耦业务逻辑。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Messaging, XiHan.Framework.Serialization, XiHan.Framework.Threading。

**基本功能：**

- 事件发布者抽象 (`IEventPublisher<T>`, `EventPublisherFactory`)
- 事件处理管道 (`IEventHandlerPipeline`, `EventHandlerComposer`)
- 事件存储管理 (`IEventStore`, `EventSourcingProvider`)
- 事件路由器 (`IEventRouter`, `TopicBasedEventRouter`)
- 事件发件箱 (`IEventOutbox`, `TransactionalEventPublisher`)
- 事件重放管理 (`IEventReplayManager`, `EventStreamRebuilder`)
- 事件订阅管理 (`IEventSubscriptionManager`, `SubscriptionRegistry`)
- 事件性能监控 (`IEventPerformanceMonitor`, `EventMetricsCollector`)

### XiHan.Framework.CodeGeneration

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 自动生成代码。
- **详细描述**: 基于 T4 模板或 Roslyn，生成实体、DTO、控制器等代码，减少重复劳动。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Templating, XiHan.Framework.Utils, XiHan.Framework.Serialization。

**基本功能：**

- 代码生成引擎 (`ICodeGenerationEngine`, `CodeGeneratorFactory`)
- 代码模板解析器 (`ITemplateParser`, `TemplateAstProcessor`)
- 代码元数据分析 (`IMetadataAnalyzer`, `ReflectionBasedAnalyzer`)
- 代码生成上下文 (`ICodeGenerationContext`, `GenerationContextBuilder`)
- 代码输出管理 (`ICodeOutputManager`, `FileSystemOutputProvider`)
- 代码格式化器 (`ICodeFormatter`, `RoslynFormattingProvider`)
- 代码验证器 (`IGeneratedCodeValidator`, `CompilationValidator`)
- 代码生成管道 (`ICodeGenerationPipeline`, `GenerationStageProcessor`)

### XiHan.Framework.Bot

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供多平台消息机器人集成。
- **详细描述**: 支持 Telegram、WhatsApp、企业微信、钉钉、飞书、Email、SMS 等多种消息平台，提供统一的机器人 API 和消息处理机制，适用于客服、通知、自动化等场景。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.Http, XiHan.Framework.AI, XiHan.Framework.Messaging。

**基本功能：**

- 机器人框架 (`IBotFramework`, `BotOrchestrator`)
- 平台适配器工厂 (`IPlatformAdapterFactory`, `AdapterRegistry`)
- 对话管理器 (`IConversationManager`, `ConversationStateTracker`)
- 消息路由器 (`IMessageRouter`, `IntentBasedRouter`)
- 机器人中间件 (`IBotMiddleware`, `MiddlewarePipeline`)
- 意图识别器 (`IIntentRecognizer`, `NluProvider`)
- 机器人状态管理 (`IBotStateManager`, `ConversationMemory`)
- 多平台消息广播 (`IMultiPlatformBroadcaster`, `MessageDistributor`)

### XiHan.Framework.Settings

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 管理应用配置和设置。
- **详细描述**: 支持动态配置、数据库存储配置、租户级设置等，灵活控制应用行为。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Data, XiHan.Framework.Validation, XiHan.Framework.Caching。

**基本功能：**

- 配置提供者 (`IConfigurationProvider<T>`, `ConfigurationProviderFactory`)
- 设置值解析器 (`ISettingValueResolver`, `TypedSettingResolver`)
- 动态配置管理 (`IDynamicConfigurationManager`, `RuntimeConfigurationProvider`)
- 配置变更通知 (`IConfigurationChangeNotifier`, `ConfigurationWatcher`)
- 设置分组管理 (`ISettingGroupManager`, `HierarchicalSettingProvider`)
- 配置验证器 (`IConfigurationValidator<T>`, `SettingConstraintValidator`)
- 配置正合器 (`IConfigurationMerger`, `ConfigurationOverrideManager`)
- 配置备份管理 (`IConfigurationBackupManager`, `SettingSnapshotProvider`)

### XiHan.Framework.MultiTenancy

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 支持多租户架构。
- **详细描述**: 提供租户隔离策略、租户解析中间件和租户管理 API，支持数据和配置的租户级隔离，适用于 SaaS 应用。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Data, XiHan.Framework.Settings, XiHan.Framework.Authentication, XiHan.Framework.Security, XiHan.Framework.Caching。

**基本功能：**

- 租户上下文管理 (`ITenantContext`, `TenantContextAccessor`)
- 租户解析器链 (`ITenantResolverChain`, `TenantResolutionPipeline`)
- 租户数据隔离 (`ITenantDataIsolator`, `DatabaseTenantIsolator`)
- 租户配置管理 (`ITenantConfigurationManager`, `PerTenantConfigurationProvider`)
- 租户生命周期管理 (`ITenantLifecycleManager`, `TenantProvisioningService`)
- 租户资源管理 (`ITenantResourceManager`, `TenantQuotaManager`)
- 多租户安全管理 (`IMultiTenantSecurityManager`, `TenantSecurityPolicyProvider`)
- 租户数据迁移 (`ITenantDataMigrator`, `TenantUpgradeManager`)

### XiHan.Framework.Application

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供应用服务层的基础设施和通用功能。
- **详细描述**: 实现 CQRS 模式、应用服务基类、DTO 基类、查询对象、应用服务接口、契约定义等，为业务应用提供完整统一的应用层架构。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Serialization, XiHan.Framework.ObjectMapping, XiHan.Framework.Validation, XiHan.Framework.Data, XiHan.Framework.Caching, XiHan.Framework.Authentication, XiHan.Framework.Messaging, XiHan.Framework.EventBus, XiHan.Framework.BackgroundJobs。

**基本功能：**

- 应用服务工厂 (`IApplicationServiceFactory<T>`, `ServiceLifecycleManager`)
- CQRS 调度器 (`IMediator`, `CommandDispatcher`, `QueryDispatcher`)
- 请求管道 (`IRequestPipeline<TRequest, TResponse>`, `PipelineBehavior<T>`)
- 应用事务管理 (`IApplicationTransactionManager`, `TransactionScopeProvider`)
- DTO 转换管道 (`IDtoMappingPipeline<TSource, TDestination>`, `DtoProjector`)
- 查询构建器 (`IQueryBuilder<T>`, `DynamicQueryComposer`, `FilterExpressionBuilder`)
- 应用层验证 (`IApplicationValidator<T>`, `ValidationBehavior<T>`)
- 应用服务上下文 (`IApplicationContext`, `OperationContextAccessor`)
- 应用事件处理 (`IApplicationEventHandler<T>`, `EventBus`, `EventStore`)
- 应用服务监控 (`IApplicationMetrics`, `PerformanceTracker`, `ServiceHealthMonitor`)

### XiHan.Framework.Web.Api

- **SDK**: Microsoft.NET.Sdk.Web
- **简要功能**: 助力 RESTful API 开发与管理。
- **详细描述**: 提供控制器基类、路由管理和模型绑定，支持 OpenAPI、System.Text.Json、API 版本控制，优化 API 开发体验。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Web.Core, XiHan.Framework.Application, XiHan.Framework.Validation, XiHan.Framework.ObjectMapping, XiHan.Framework.Serialization。

**基本功能：**

- API 控制器工厂 (`IApiControllerFactory`, `ControllerActivator`)
- 路由管理器 (`IRouteManager`, `ConventionBasedRouteBuilder`)
- 模型绑定器 (`IModelBinder<T>`, `CustomModelBinderProvider`)
- API 版本协商 (`IApiVersionNegotiator`, `VersioningStrategyProvider`)
- 响应格式化器 (`IResponseFormatter<T>`, `ContentNegotiationHandler`)
- API 文档生成器 (`IApiDocumentationGenerator`, `OpenApiSchemaBuilder`)
- 请求/响应拦截器 (`IApiInterceptor`, `ApiInterceptorPipeline`)
- API 性能监控 (`IApiPerformanceMonitor`, `ApiMetricsCollector`)
- CQRS 路由器 (`ICqrsRouteHandler`, `CommandQueryDispatcher`)

### XiHan.Framework.Web.Docs

- **SDK**: Microsoft.NET.Sdk.Web
- **简要功能**: 生成 API 文档和客户端代码。
- **详细描述**: 集成 Swashbuckle 和 Scalar，支持交互式 OpenAPI 文档生成和客户端代码（如 TypeScript SDK）输出，方便开发与集成。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Web.Api, XiHan.Framework.Templating, XiHan.Framework.CodeGeneration。

**基本功能：**

- API 文档生成器 (`IApiDocumentationGenerator`, `OpenApiDocumentBuilder`)
- 文档模块加载器 (`IDocumentationModuleLoader`, `DocumentationExtensionProvider`)
- 客户端代码生成器 (`IClientCodeGenerator<T>`, `TypeScriptSdkGenerator`)
- API 测试客户端 (`IApiTestClient`, `SwaggerUITestRunner`)
- 文档模板引擎 (`IDocumentationTemplateEngine`, `CustomizableDocRenderer`)
- API 示例生成器 (`IApiExampleGenerator`, `RequestResponseExampleProvider`)
- 文档版本管理 (`IDocumentationVersionManager`, `ApiVersionDocumentationProvider`)
- 交互式文档 (`IInteractiveDocumentationProvider`, `ApiExplorerExtensions`)

### XiHan.Framework.Web.RealTime

- **SDK**: Microsoft.NET.Sdk.Web
- **简要功能**: 实现实时 Web 通信。
- **详细描述**: 基于 ASP.NET Core SignalR，支持消息推送、实时通知和双向通信，适用于聊天、动态更新等场景。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Web.Core, XiHan.Framework.Authentication, XiHan.Framework.Messaging, XiHan.Framework.EventBus。

**基本功能：**

- 实时通信中心 (`IRealTimeCommunicationHub`, `HubConnectionManager`)
- 消息分发器 (`IMessageDispatcher`, `RealTimeMessageRouter`)
- 连接状态管理 (`IConnectionStateManager`, `ConnectionPoolManager`)
- 实时数据同步 (`IRealTimeDataSynchronizer`, `DataStreamManager`)
- 组管理器 (`IGroupManager`, `DynamicGroupProvider`)
- 实时事件管理 (`IRealTimeEventManager`, `EventStreamProvider`)
- 实时安全管理 (`IRealTimeSecurityManager`, `ConnectionSecurityValidator`)
- 实时性能监控 (`IRealTimePerformanceMonitor`, `ConnectionMetricsCollector`)

### XiHan.Framework.Web.Gateway

- **SDK**: Microsoft.NET.Sdk.Web
- **简要功能**: 实现 API 网关。
- **详细描述**: 基于 Ocelot 或 YARP，提供路由、负载均衡、认证等功能，管理微服务 API（可选模块）。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Web.Core, XiHan.Framework.Authentication, XiHan.Framework.Http, XiHan.Framework.Caching, XiHan.Framework.Security。

**基本功能：**

- 网关路由引擎 (`IGatewayRoutingEngine`, `RequestRoutingProcessor`)
- 服务发现中心 (`IServiceDiscoveryCenter`, `ServiceRegistryProvider`)
- 负载均衡策略 (`ILoadBalancingStrategy`, `HealthBasedLoadBalancer`)
- API 网关中间件 (`IGatewayMiddleware`, `GatewayPipelineBuilder`)
- 网关限流管理 (`IRateLimitingManager`, `DistributedRateLimiter`)
- 请求聚合器 (`IRequestAggregator`, `GraphQLRequestComposer`)
- 网关缓存管理 (`IGatewayCacheManager`, `ResponseCacheProvider`)
- 网关安全管理 (`IGatewaySecurityManager`, `ApiKeyValidator`)

### XiHan.Framework.DevTools

- **SDK**: Microsoft.NET.Sdk
- **简要功能**: 提供开发与调试工具集。
- **详细描述**: 包含 xUnit 测试框架、Moq 模拟工具和性能监控功能，助力开发、测试和问题排查。
- **依赖**: XiHan.Framework.Core, XiHan.Framework.Utils, XiHan.Framework.Validation。

**基本功能：**

- 测试基础设施 (`ITestFramework`, `TestContextProvider`)
- 测试数据构建器 (`ITestDataBuilder<T>`, `FixtureFactory`)
- 性能分析器 (`IPerformanceProfiler`, `PerformanceBenchmarkRunner`)
- 开发诊断工具 (`IDevelopmentDiagnostics`, `HealthCheckAggregator`)
- 测试双/模拟管理 (`ITestDoubleManager`, `MockProvider`)
- 集成测试支持 (`IIntegrationTestSupport`, `TestEnvironmentManager`)
- 代码质量分析 (`ICodeQualityAnalyzer`, `StaticAnalysisRunner`)
- 开发者体验工具 (`IDeveloperExperienceTools`, `LiveReloadProvider`)

---

## 前后端分离支持

- **XiHan.Framework.Web.Docs** 生成 OpenAPI 或 gRPC 客户端代码，支持 React、Vue、Angular 等前端框架。
- **XiHan.Framework.Web.Api** 和 **XiHan.Framework.Web.RealTime** 提供高效 API 和实时通信，简化前后端协作。

## 开发和发布流程

1. **项目结构**
   - 通用功能使用 `Microsoft.NET.Sdk`，命名为 `XiHan.Framework.[ModuleName]`。
   - Web 功能使用 `Microsoft.NET.Sdk.Web`，命名为 `XiHan.Framework.Web.[ModuleName]`。
2. **打包**  
   使用 `dotnet pack` 创建 NuGet 包，配置正确元数据（版本、描述、依赖）。
3. **发布**  
   在 NuGet.org 发布，支持预发布版本（如 `1.0.0-beta`）。
4. **版本管理**  
   遵循语义化版本控制（SemVer），同步所有包版本。
5. **CI/CD**  
   使用 GitHub Actions 自动化构建、测试和发布。

## 示例项目

提供 GitHub/Gitee 托管的示例项目，展示包的使用：

- **快速启动项目**：使用最小包集合 (`XiHan.Framework.Web.Api`, `XiHan.Framework.Web.Docs`) 创建可运行的 Web API。
- **完整 RESTful API**：`XiHan.Framework.Web.Api`, `XiHan.Framework.Data`, `XiHan.Framework.Authentication`。
- **认证和授权**：`XiHan.Framework.Authentication`, `XiHan.Framework.Authorization`。
- **实时通信**：`XiHan.Framework.Web.RealTime`。
- **监控和日志**：`XiHan.Framework.DevTools`, `XiHan.Framework.Logging`。
- **国际化与本地化**：`XiHan.Framework.Localization`。
- **多租户**：`XiHan.Framework.MultiTenancy`。
- **消息机器人**：`XiHan.Framework.Bot`。
- **脚本执行**：`XiHan.Framework.Script`。

## 注意事项

- **精简依赖**：优先使用 .NET 9 原生功能（如内置 DI、日志、序列化），仅在必要时兼容第三方库（如 Redis、HotChocolate）。
- **国内环境**：提供中文文档，托管在 Gitee，支持国内 NuGet 镜像。
- **国际标准**：支持 OpenAPI、gRPC、Swagger，符合全球开发者习惯。
- **性能优化**：利用 .NET 9 AOT 编译，提供性能基准数据。
- **社区支持**：为每个包提供 GitHub/Gitee 仓库，支持问题反馈和贡献。
- **快速体验**：确保用户使用核心包组合能在 5 分钟内启动完整的 Web API 项目。

## 使用示例

### 快速启动（最小化配置）

```bash
// 添加元数据包（必需）
dotnet add package XiHan.Framework

// 添加 Web API 核心包（快速启动）
dotnet add package XiHan.Framework.Web.Api
dotnet add package XiHan.Framework.Web.Docs
dotnet add package XiHan.Framework.Logging
```

### 完整功能（推荐配置）

```bash
// 添加完整的 Web API 解决方案
dotnet add package XiHan.Framework.Web.Api
dotnet add package XiHan.Framework.Web.Docs
dotnet add package XiHan.Framework.Application
dotnet add package XiHan.Framework.Data
dotnet add package XiHan.Framework.Authentication
dotnet add package XiHan.Framework.Caching
dotnet add package XiHan.Framework.Validation
dotnet add package XiHan.Framework.ObjectMapping
```

### 扩展功能（按需添加）

```bash
// 添加扩展包（按需）
dotnet add package XiHan.Framework.Web.RealTime
dotnet add package XiHan.Framework.BackgroundJobs
dotnet add package XiHan.Framework.Localization
dotnet add package XiHan.Framework.MultiTenancy
dotnet add package XiHan.Framework.Bot
```

## 架构优势

### 1. 清晰的分层架构

- **表现层**：Web API、文档生成、实时通信
- **应用层**：应用服务、CQRS、业务编排
- **领域层**：领域模型、业务规则、领域服务
- **基础设施层**：数据访问、缓存、消息队列、安全等

### 2. 依赖关系清晰

- 遵循依赖倒置原则
- 避免循环依赖
- 清晰的包依赖层次

### 3. 模块化设计

- 每个包职责单一
- 支持按需引用
- 易于扩展和维护

### 4. 符合 DDD 原则

- 应用服务层处理业务编排
- 领域层包含核心业务逻辑
- 基础设施层提供技术实现

### 5. 支持 CQRS 模式

- 命令和查询分离
- 支持读写分离
- 优化查询性能
